<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenVAF Viz - ekv</title>
    <style>

:root {
    --bg-primary: #1e1e1e;
    --bg-secondary: #252526;
    --bg-tertiary: #2d2d30;
    --text-primary: #d4d4d4;
    --text-secondary: #9cdcfe;
    --text-muted: #808080;
    --accent: #569cd6;
    --accent-secondary: #4ec9b0;
    --border: #3c3c3c;
    --success: #4caf50;
    --warning: #ff9800;
    --error: #f44336;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 13px;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.5;
}

.container {
    display: flex;
    height: 100vh;
}

.sidebar {
    width: 300px;
    background: var(--bg-secondary);
    border-right: 1px solid var(--border);
    overflow-y: auto;
    flex-shrink: 0;
}

.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.header {
    padding: 12px 16px;
    background: var(--bg-tertiary);
    border-bottom: 1px solid var(--border);
}

.header h1 {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-secondary);
}

.tabs {
    display: flex;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border);
}

.tab {
    padding: 8px 16px;
    cursor: pointer;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-family: inherit;
    font-size: 13px;
    border-bottom: 2px solid transparent;
}

.tab:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.tab.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
}

.panel {
    flex: 1;
    overflow: auto;
    padding: 16px;
}

.panel-hidden {
    display: none;
}

/* Sidebar sections */
.section {
    border-bottom: 1px solid var(--border);
}

.section-header {
    padding: 10px 16px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-tertiary);
}

.section-header:hover {
    background: var(--bg-primary);
}

.section-header h3 {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
}

.section-content {
    padding: 8px 0;
}

.section-content.collapsed {
    display: none;
}

/* Tree items */
.tree-item {
    padding: 4px 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
}

.tree-item:hover {
    background: var(--bg-tertiary);
}

.tree-item.selected {
    background: var(--accent);
    background-opacity: 0.2;
}

.tree-item .icon {
    width: 16px;
    text-align: center;
    color: var(--text-muted);
}

/* Stats */
.stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    padding: 16px;
}

.stat {
    background: var(--bg-tertiary);
    padding: 12px;
    border-radius: 4px;
}

.stat-value {
    font-size: 24px;
    font-weight: 600;
    color: var(--accent-secondary);
}

.stat-label {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
}

/* CFG visualization */
#cfg-container {
    width: 100%;
    height: 100%;
    background: var(--bg-primary);
}

/* Instruction list */
.block {
    margin-bottom: 16px;
    background: var(--bg-secondary);
    border-radius: 4px;
    overflow: hidden;
}

.block-header {
    padding: 8px 12px;
    background: var(--bg-tertiary);
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
}

.block-header:hover {
    background: var(--bg-primary);
}

.block-name {
    color: var(--accent);
    font-weight: 600;
}

.block-meta {
    color: var(--text-muted);
    font-size: 11px;
}

.block-content {
    padding: 8px 0;
}

.instruction {
    padding: 4px 12px;
    display: flex;
    gap: 12px;
    font-family: inherit;
}

.instruction:hover {
    background: var(--bg-tertiary);
}

.inst-result {
    color: var(--accent-secondary);
    min-width: 60px;
}

.inst-opcode {
    color: var(--accent);
    min-width: 80px;
}

.inst-args {
    color: var(--text-primary);
}

.inst-opcode.arithmetic { color: #ce9178; }
.inst-opcode.math { color: #b5cea8; }
.inst-opcode.comparison { color: #c586c0; }
.inst-opcode.control_flow { color: #569cd6; }
.inst-opcode.phi { color: #4ec9b0; }
.inst-opcode.call { color: #dcdcaa; }

/* Value references */
.value-ref {
    color: var(--accent-secondary);
    cursor: pointer;
    text-decoration: underline;
    text-decoration-style: dotted;
}

.value-ref:hover {
    text-decoration-style: solid;
}

/* Search */
.search-box {
    padding: 8px 16px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border);
}

.search-input {
    width: 100%;
    padding: 8px 12px;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--text-primary);
    font-family: inherit;
    font-size: 13px;
}

.search-input:focus {
    outline: none;
    border-color: var(--accent);
}

/* Tooltip */
.tooltip {
    position: fixed;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 8px 12px;
    max-width: 400px;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.tooltip-title {
    color: var(--accent-secondary);
    font-weight: 600;
    margin-bottom: 4px;
}

.tooltip-content {
    color: var(--text-primary);
    font-size: 12px;
}

/* Pre/code for text summary */
pre {
    background: var(--bg-secondary);
    padding: 16px;
    border-radius: 4px;
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/* Graph visualization */
.graph-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
    position: relative;
}

.graph-controls {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 8px;
    z-index: 100;
}

.graph-btn {
    padding: 6px 12px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--text-primary);
    cursor: pointer;
    font-family: inherit;
    font-size: 12px;
}

.graph-btn:hover {
    background: var(--bg-secondary);
    border-color: var(--accent);
}

#cfg-graph {
    width: 100%;
    height: 100%;
}

#cfg-graph svg {
    width: 100%;
    height: 100%;
}

/* Graph node styles */
.node rect {
    stroke: var(--border);
    stroke-width: 2px;
    rx: 4;
    ry: 4;
}

.node.entry rect {
    fill: #2d5a3d;
    stroke: #4caf50;
}

.node.exit rect {
    fill: #5a2d3d;
    stroke: #f44336;
}

.node.loop-header rect {
    fill: #5a4d2d;
    stroke: #ff9800;
}

.node.normal rect {
    fill: var(--bg-tertiary);
    stroke: var(--border);
}

.node.selected rect {
    stroke: var(--accent);
    stroke-width: 3px;
}

.node:hover rect {
    stroke: var(--accent-secondary);
    cursor: pointer;
}

.node text {
    fill: var(--text-primary);
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 11px;
}

.node .block-title {
    font-weight: bold;
    fill: var(--accent);
}

.node .block-info {
    fill: var(--text-muted);
    font-size: 10px;
}

/* Edge styles */
.edgePath path {
    stroke: var(--text-muted);
    stroke-width: 1.5px;
    fill: none;
}

.edgePath.true-branch path {
    stroke: #4caf50;
    stroke-width: 2px;
}

.edgePath.false-branch path {
    stroke: #f44336;
    stroke-width: 2px;
}

.edgePath.back-edge path {
    stroke: var(--warning);
    stroke-dasharray: 5, 3;
}

.edgeLabel {
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 10px;
    font-weight: bold;
}

.edgeLabel .label-true {
    fill: #4caf50;
}

.edgeLabel .label-false {
    fill: #f44336;
}

marker#arrowhead path {
    fill: var(--text-muted);
}

/* View mode tabs */
.view-tabs {
    display: flex;
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border);
    padding: 0 16px;
}

.view-tab {
    padding: 8px 16px;
    cursor: pointer;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-family: inherit;
    font-size: 12px;
    border-bottom: 2px solid transparent;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.view-tab:hover {
    color: var(--text-primary);
}

.view-tab.active {
    color: var(--accent-secondary);
    border-bottom-color: var(--accent-secondary);
}

/* Node tooltip */
.graph-tooltip {
    position: absolute;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 12px;
    max-width: 350px;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    pointer-events: none;
    font-size: 11px;
}

.graph-tooltip .tooltip-header {
    color: var(--accent);
    font-weight: bold;
    margin-bottom: 8px;
    font-size: 12px;
}

.graph-tooltip .tooltip-inst {
    color: var(--text-primary);
    margin: 2px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.graph-tooltip .tooltip-meta {
    color: var(--text-muted);
    margin-top: 8px;
    font-size: 10px;
}

/* Data Flow Graph Nodes */
.node.instruction rect {
    fill: var(--bg-tertiary);
    stroke: var(--accent);
}

.node.value rect {
    fill: #2d3a5a;
    stroke: #569cd6;
    rx: 10;
    ry: 10;
}

.node.const rect {
    fill: #3d2d4a;
    stroke: #c586c0;
    rx: 10;
    ry: 10;
}

.node.param rect {
    fill: #2d4a3d;
    stroke: #4ec9b0;
    rx: 10;
    ry: 10;
}

/* Data Flow Edge Types */
.edgePath.def path {
    stroke: #4ec9b0;
    stroke-width: 2px;
}

.edgePath.use path {
    stroke: #569cd6;
    stroke-width: 1.5px;
}

.edgePath.phi path {
    stroke: #c586c0;
    stroke-dasharray: 3, 2;
}

/* Topology Graph Nodes */
.node.kirchoff_law rect {
    fill: #2d5a3d;
    stroke: #4caf50;
}

.node.branch_current rect,
.node.unnamed_current rect,
.node.port_current rect {
    fill: #5a4d2d;
    stroke: #ff9800;
}

.node.implicit rect {
    fill: #3d2d5a;
    stroke: #9c27b0;
}

/* Topology Edge Types */
.edgePath.jacobian_resist path {
    stroke: #4caf50;
    stroke-width: 2px;
}

.edgePath.jacobian_react path {
    stroke: #2196f3;
    stroke-width: 2px;
    stroke-dasharray: 5, 3;
}

.edgePath.both path {
    stroke: #ff9800;
    stroke-width: 2.5px;
}

/* Jacobian Matrix */
.jacobian-matrix {
    display: inline-block;
    background: var(--bg-secondary);
    padding: 16px;
    border-radius: 8px;
}

.jacobian-title {
    font-size: 14px;
    font-weight: bold;
    color: var(--accent);
    margin-bottom: 12px;
}

.jacobian-stats {
    display: flex;
    gap: 24px;
    margin-bottom: 16px;
    color: var(--text-muted);
    font-size: 12px;
}

.jacobian-grid {
    display: grid;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 4px;
    overflow: hidden;
}

.jacobian-cell {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    cursor: pointer;
    transition: transform 0.1s;
}

.jacobian-cell:hover {
    transform: scale(1.5);
    z-index: 10;
    position: relative;
}

.jacobian-cell.empty {
    background: var(--bg-primary);
}

.jacobian-cell.resist {
    background: #2d5a3d;
}

.jacobian-cell.react {
    background: #2d3d5a;
}

.jacobian-cell.both {
    background: #5a4d2d;
}

.jacobian-cell.diagonal {
    border: 2px solid var(--accent);
}

.jacobian-header {
    background: var(--bg-tertiary);
    color: var(--text-muted);
    font-size: 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 2px;
}

.jacobian-row-header {
    writing-mode: horizontal-tb;
    text-align: right;
    padding-right: 4px;
}

.jacobian-col-header {
    writing-mode: vertical-rl;
    text-orientation: mixed;
    transform: rotate(180deg);
    text-align: left;
    padding-top: 4px;
}

.jacobian-legend {
    display: flex;
    gap: 16px;
    margin-top: 12px;
    font-size: 11px;
}

.jacobian-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.jacobian-legend-color {
    width: 16px;
    height: 16px;
    border-radius: 2px;
}

    </style>
    <!-- D3.js and dagre for graph visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dagre@0.8.5/dist/dagre.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="sidebar" id="sidebar">
            <!-- Populated by JavaScript -->
        </div>
        <div class="main-content">
            <div class="header">
                <h1>OpenVAF IR Visualization: ekv</h1>
            </div>
            <div class="search-box">
                <input type="text" id="search-input" class="search-input"
                       placeholder="Search instructions (e.g., fadd, v123, block0)...">
            </div>
            <div class="tabs" id="tabs">
                <!-- Populated by JavaScript -->
            </div>
            <div class="panel" id="panel">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Module data embedded as JSON
        window.MODULE_DATA = {
  "module_name": "ekv",
  "ports": [
    "d",
    "g",
    "s",
    "b"
  ],
  "internal_nodes": [],
  "eval": {
    "name": "eval",
    "num_blocks": 7,
    "num_instructions": 142,
    "num_values": 274,
    "blocks": [
      {
        "id": "block8",
        "instructions": [
          {
            "id": "inst0",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param0",
              "param6"
            ],
            "results": [
              "v23"
            ]
          },
          {
            "id": "inst1",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v23",
              "param7"
            ],
            "results": [
              "v25"
            ]
          },
          {
            "id": "inst2",
            "opcode": "sqrt",
            "opcode_category": "math",
            "arguments": [
              "param7"
            ],
            "results": [
              "v27"
            ]
          },
          {
            "id": "inst3",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param8",
              "v27"
            ],
            "results": [
              "v28"
            ]
          },
          {
            "id": "inst4",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v25",
              "v28"
            ],
            "results": [
              "v29"
            ]
          },
          {
            "id": "inst5",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param8",
              "2"
            ],
            "results": [
              "v31"
            ]
          },
          {
            "id": "inst7",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v31",
              "v31"
            ],
            "results": [
              "v33"
            ]
          },
          {
            "id": "inst8",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v29",
              "v33"
            ],
            "results": [
              "v34"
            ]
          },
          {
            "id": "inst9",
            "opcode": "fgt",
            "opcode_category": "comparison",
            "arguments": [
              "v34",
              "0.000000000001"
            ],
            "results": [
              "v36"
            ]
          },
          {
            "id": "inst10",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v36"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block2",
              "else_block": "block3"
            }
          }
        ],
        "predecessors": [],
        "successors": [
          "block3",
          "block2"
        ]
      },
      {
        "id": "block2",
        "instructions": [
          {
            "id": "inst11",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v29",
              "param7"
            ],
            "results": [
              "v38"
            ]
          },
          {
            "id": "inst16",
            "opcode": "sqrt",
            "opcode_category": "math",
            "arguments": [
              "v34"
            ],
            "results": [
              "v43"
            ]
          },
          {
            "id": "inst100",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "2",
              "v43"
            ],
            "results": [
              "v165"
            ]
          },
          {
            "id": "inst101",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v165"
            ],
            "results": [
              "v166"
            ]
          },
          {
            "id": "inst18",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v43",
              "v31"
            ],
            "results": [
              "v45"
            ]
          },
          {
            "id": "inst19",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param8",
              "v45"
            ],
            "results": [
              "v46"
            ]
          },
          {
            "id": "inst103",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v166",
              "param8"
            ],
            "results": [
              "v168"
            ]
          },
          {
            "id": "inst20",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v38",
              "v46"
            ],
            "results": [
              "v47"
            ]
          },
          {
            "id": "inst104",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v168"
            ],
            "results": [
              "v169"
            ]
          },
          {
            "id": "inst21",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block8"
        ],
        "successors": [
          "block4"
        ]
      },
      {
        "id": "block3",
        "instructions": [
          {
            "id": "inst22",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v29",
              "param7"
            ],
            "results": [
              "v50"
            ]
          },
          {
            "id": "inst23",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param8",
              "param8"
            ],
            "results": [
              "v51"
            ]
          },
          {
            "id": "inst24",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v51",
              "2"
            ],
            "results": [
              "v52"
            ]
          },
          {
            "id": "inst25",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v50",
              "v52"
            ],
            "results": [
              "v53"
            ]
          },
          {
            "id": "inst26",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block8"
        ],
        "successors": [
          "block4"
        ]
      },
      {
        "id": "block4",
        "instructions": [
          {
            "id": "inst27",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block2: v47",
              "block3: v53"
            ],
            "results": [
              "v54"
            ]
          },
          {
            "id": "inst105",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block2: v169",
              "block3: 1"
            ],
            "results": [
              "v170"
            ]
          },
          {
            "id": "inst28",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param7",
              "v54"
            ],
            "results": [
              "v55"
            ]
          },
          {
            "id": "inst29",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "0.00008617332384960955",
              "param11"
            ],
            "results": [
              "v59"
            ]
          },
          {
            "id": "inst30",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "4",
              "v59"
            ],
            "results": [
              "v60"
            ]
          },
          {
            "id": "inst31",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v55",
              "v60"
            ],
            "results": [
              "v61"
            ]
          },
          {
            "id": "inst32",
            "opcode": "fgt",
            "opcode_category": "comparison",
            "arguments": [
              "v61",
              "0.000000000000000000000001"
            ],
            "results": [
              "v63"
            ]
          },
          {
            "id": "inst33",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v63"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block5",
              "else_block": "block6"
            }
          }
        ],
        "predecessors": [
          "block2",
          "block3"
        ],
        "successors": [
          "block6",
          "block5"
        ]
      },
      {
        "id": "block5",
        "instructions": [
          {
            "id": "inst38",
            "opcode": "sqrt",
            "opcode_category": "math",
            "arguments": [
              "v61"
            ],
            "results": [
              "v69"
            ]
          },
          {
            "id": "inst108",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "2",
              "v69"
            ],
            "results": [
              "v173"
            ]
          },
          {
            "id": "inst109",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v170",
              "v173"
            ],
            "results": [
              "v174"
            ]
          },
          {
            "id": "inst110",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v174",
              "2"
            ],
            "results": [
              "v175"
            ]
          },
          {
            "id": "inst40",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param8",
              "v173"
            ],
            "results": [
              "v71"
            ]
          },
          {
            "id": "inst111",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v173",
              "v173"
            ],
            "results": [
              "v176"
            ]
          },
          {
            "id": "inst112",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v175",
              "param8"
            ],
            "results": [
              "v177"
            ]
          },
          {
            "id": "inst113",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v177",
              "v176"
            ],
            "results": [
              "v178"
            ]
          },
          {
            "id": "inst114",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "0",
              "v178"
            ],
            "results": [
              "v179"
            ]
          },
          {
            "id": "inst41",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v71"
            ],
            "results": [
              "v72"
            ]
          },
          {
            "id": "inst42",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block4"
        ],
        "successors": [
          "block7"
        ]
      },
      {
        "id": "block6",
        "instructions": [
          {
            "id": "inst45",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v31",
              "1000000000000000000000000000000000000000000000000"
            ],
            "results": [
              "v78"
            ]
          },
          {
            "id": "inst46",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v78"
            ],
            "results": [
              "v79"
            ]
          },
          {
            "id": "inst47",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block4"
        ],
        "successors": [
          "block7"
        ]
      },
      {
        "id": "block7",
        "instructions": [
          {
            "id": "inst79",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block5: v72",
              "block6: v79"
            ],
            "results": [
              "v133"
            ]
          },
          {
            "id": "inst116",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block5: v179",
              "block6: 0"
            ],
            "results": [
              "v181"
            ]
          },
          {
            "id": "inst48",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param14",
              "param15"
            ],
            "results": [
              "v83"
            ]
          },
          {
            "id": "inst49",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param13",
              "v83"
            ],
            "results": [
              "v84"
            ]
          },
          {
            "id": "inst50",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param16",
              "v54"
            ],
            "results": [
              "v88"
            ]
          },
          {
            "id": "inst117",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v170",
              "param16"
            ],
            "results": [
              "v182"
            ]
          },
          {
            "id": "inst51",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v88"
            ],
            "results": [
              "v89"
            ]
          },
          {
            "id": "inst52",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v89"
            ],
            "results": [
              "v90"
            ]
          },
          {
            "id": "inst119",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v89",
              "v89"
            ],
            "results": [
              "v184"
            ]
          },
          {
            "id": "inst121",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v182",
              "v184"
            ],
            "results": [
              "v186"
            ]
          },
          {
            "id": "inst122",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "0",
              "v186"
            ],
            "results": [
              "v187"
            ]
          },
          {
            "id": "inst53",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v84",
              "v90"
            ],
            "results": [
              "v91"
            ]
          },
          {
            "id": "inst123",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v187",
              "v84"
            ],
            "results": [
              "v188"
            ]
          },
          {
            "id": "inst54",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v54",
              "param2"
            ],
            "results": [
              "v99"
            ]
          },
          {
            "id": "inst56",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v99",
              "v59"
            ],
            "results": [
              "v101"
            ]
          },
          {
            "id": "inst127",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v170",
              "v59"
            ],
            "results": [
              "v192"
            ]
          },
          {
            "id": "inst128",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "-1",
              "v59"
            ],
            "results": [
              "v193"
            ]
          },
          {
            "id": "inst57",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v101",
              "2"
            ],
            "results": [
              "v103"
            ]
          },
          {
            "id": "inst130",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v192",
              "2"
            ],
            "results": [
              "v195"
            ]
          },
          {
            "id": "inst131",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v193",
              "2"
            ],
            "results": [
              "v196"
            ]
          },
          {
            "id": "inst58",
            "opcode": "exp",
            "opcode_category": "math",
            "arguments": [
              "v103"
            ],
            "results": [
              "v104"
            ]
          },
          {
            "id": "inst133",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v195",
              "v104"
            ],
            "results": [
              "v198"
            ]
          },
          {
            "id": "inst134",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v196",
              "v104"
            ],
            "results": [
              "v199"
            ]
          },
          {
            "id": "inst59",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v104"
            ],
            "results": [
              "v105"
            ]
          },
          {
            "id": "inst60",
            "opcode": "ln",
            "opcode_category": "math",
            "arguments": [
              "v105"
            ],
            "results": [
              "v106"
            ]
          },
          {
            "id": "inst137",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v198",
              "v105"
            ],
            "results": [
              "v202"
            ]
          },
          {
            "id": "inst138",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v199",
              "v105"
            ],
            "results": [
              "v203"
            ]
          },
          {
            "id": "inst65",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v106",
              "v106"
            ],
            "results": [
              "v111"
            ]
          },
          {
            "id": "inst139",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v202",
              "v106"
            ],
            "results": [
              "v204"
            ]
          },
          {
            "id": "inst141",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v204",
              "v204"
            ],
            "results": [
              "v206"
            ]
          },
          {
            "id": "inst142",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v203",
              "v106"
            ],
            "results": [
              "v207"
            ]
          },
          {
            "id": "inst144",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v207",
              "v207"
            ],
            "results": [
              "v209"
            ]
          },
          {
            "id": "inst66",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v54",
              "param4"
            ],
            "results": [
              "v119"
            ]
          },
          {
            "id": "inst68",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v119",
              "v59"
            ],
            "results": [
              "v121"
            ]
          },
          {
            "id": "inst69",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v121",
              "2"
            ],
            "results": [
              "v122"
            ]
          },
          {
            "id": "inst70",
            "opcode": "exp",
            "opcode_category": "math",
            "arguments": [
              "v122"
            ],
            "results": [
              "v123"
            ]
          },
          {
            "id": "inst154",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v195",
              "v123"
            ],
            "results": [
              "v219"
            ]
          },
          {
            "id": "inst155",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v196",
              "v123"
            ],
            "results": [
              "v220"
            ]
          },
          {
            "id": "inst71",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "1",
              "v123"
            ],
            "results": [
              "v124"
            ]
          },
          {
            "id": "inst72",
            "opcode": "ln",
            "opcode_category": "math",
            "arguments": [
              "v124"
            ],
            "results": [
              "v125"
            ]
          },
          {
            "id": "inst158",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v219",
              "v124"
            ],
            "results": [
              "v223"
            ]
          },
          {
            "id": "inst159",
            "opcode": "fdiv",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v220",
              "v124"
            ],
            "results": [
              "v224"
            ]
          },
          {
            "id": "inst77",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v125",
              "v125"
            ],
            "results": [
              "v130"
            ]
          },
          {
            "id": "inst160",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v223",
              "v125"
            ],
            "results": [
              "v225"
            ]
          },
          {
            "id": "inst162",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v225",
              "v225"
            ],
            "results": [
              "v227"
            ]
          },
          {
            "id": "inst163",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v224",
              "v125"
            ],
            "results": [
              "v228"
            ]
          },
          {
            "id": "inst165",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v228",
              "v228"
            ],
            "results": [
              "v230"
            ]
          },
          {
            "id": "inst80",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "2",
              "v133"
            ],
            "results": [
              "v134"
            ]
          },
          {
            "id": "inst166",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v181",
              "2"
            ],
            "results": [
              "v231"
            ]
          },
          {
            "id": "inst81",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v134",
              "v91"
            ],
            "results": [
              "v135"
            ]
          },
          {
            "id": "inst167",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v231",
              "v91"
            ],
            "results": [
              "v232"
            ]
          },
          {
            "id": "inst168",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v188",
              "v134"
            ],
            "results": [
              "v233"
            ]
          },
          {
            "id": "inst169",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v232",
              "v233"
            ],
            "results": [
              "v234"
            ]
          },
          {
            "id": "inst83",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v135",
              "v59"
            ],
            "results": [
              "v137"
            ]
          },
          {
            "id": "inst170",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v234",
              "v59"
            ],
            "results": [
              "v235"
            ]
          },
          {
            "id": "inst85",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v137",
              "v59"
            ],
            "results": [
              "v139"
            ]
          },
          {
            "id": "inst171",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v235",
              "v59"
            ],
            "results": [
              "v236"
            ]
          },
          {
            "id": "inst86",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v111",
              "v130"
            ],
            "results": [
              "v141"
            ]
          },
          {
            "id": "inst172",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v206",
              "v227"
            ],
            "results": [
              "v237"
            ]
          },
          {
            "id": "inst174",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "0",
              "v230"
            ],
            "results": [
              "v239"
            ]
          },
          {
            "id": "inst87",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v139",
              "v141"
            ],
            "results": [
              "v142"
            ]
          },
          {
            "id": "inst175",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v236",
              "v141"
            ],
            "results": [
              "v240"
            ]
          },
          {
            "id": "inst176",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v237",
              "v139"
            ],
            "results": [
              "v241"
            ]
          },
          {
            "id": "inst177",
            "opcode": "fadd",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v240",
              "v241"
            ],
            "results": [
              "v242"
            ]
          },
          {
            "id": "inst178",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v209",
              "v139"
            ],
            "results": [
              "v243"
            ]
          },
          {
            "id": "inst179",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v239",
              "v139"
            ],
            "results": [
              "v244"
            ]
          },
          {
            "id": "inst195",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v142"
            ],
            "results": [
              "v260"
            ]
          },
          {
            "id": "inst91",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v260"
            ],
            "results": [
              "v156"
            ]
          },
          {
            "id": "inst92",
            "opcode": "fneg",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v142"
            ],
            "results": [
              "v157"
            ]
          },
          {
            "id": "inst180",
            "opcode": "fneg",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v242"
            ],
            "results": [
              "v245"
            ]
          },
          {
            "id": "inst181",
            "opcode": "fneg",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v243"
            ],
            "results": [
              "v246"
            ]
          },
          {
            "id": "inst182",
            "opcode": "fneg",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v244"
            ],
            "results": [
              "v247"
            ]
          },
          {
            "id": "inst200",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v242"
            ],
            "results": [
              "v265"
            ]
          },
          {
            "id": "inst184",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v265"
            ],
            "results": [
              "v249"
            ]
          },
          {
            "id": "inst185",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v245",
              "v243"
            ],
            "results": [
              "v250"
            ]
          },
          {
            "id": "inst201",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v243"
            ],
            "results": [
              "v266"
            ]
          },
          {
            "id": "inst186",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v266"
            ],
            "results": [
              "v251"
            ]
          },
          {
            "id": "inst187",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v250",
              "v244"
            ],
            "results": [
              "v252"
            ]
          },
          {
            "id": "inst199",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v244"
            ],
            "results": [
              "v264"
            ]
          },
          {
            "id": "inst188",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v264"
            ],
            "results": [
              "v253"
            ]
          },
          {
            "id": "inst205",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v245"
            ],
            "results": [
              "v270"
            ]
          },
          {
            "id": "inst190",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v270"
            ],
            "results": [
              "v255"
            ]
          },
          {
            "id": "inst191",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v242",
              "v246"
            ],
            "results": [
              "v256"
            ]
          },
          {
            "id": "inst206",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v246"
            ],
            "results": [
              "v271"
            ]
          },
          {
            "id": "inst192",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v271"
            ],
            "results": [
              "v257"
            ]
          },
          {
            "id": "inst193",
            "opcode": "fsub",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "v256",
              "v247"
            ],
            "results": [
              "v258"
            ]
          },
          {
            "id": "inst204",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v247"
            ],
            "results": [
              "v269"
            ]
          },
          {
            "id": "inst194",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v269"
            ],
            "results": [
              "v259"
            ]
          },
          {
            "id": "inst197",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v157"
            ],
            "results": [
              "v262"
            ]
          },
          {
            "id": "inst196",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v262"
            ],
            "results": [
              "v261"
            ]
          },
          {
            "id": "inst198",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "param24"
            ],
            "results": [
              "v263"
            ]
          },
          {
            "id": "inst203",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v252"
            ],
            "results": [
              "v268"
            ]
          },
          {
            "id": "inst202",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v268"
            ],
            "results": [
              "v267"
            ]
          },
          {
            "id": "inst208",
            "opcode": "fmul",
            "opcode_category": "float_arithmetic",
            "arguments": [
              "param24",
              "v258"
            ],
            "results": [
              "v273"
            ]
          },
          {
            "id": "inst207",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "v273"
            ],
            "results": [
              "v272"
            ]
          }
        ],
        "predecessors": [
          "block5",
          "block6"
        ],
        "successors": []
      }
    ]
  },
  "init": {
    "name": "init",
    "num_blocks": 3,
    "num_instructions": 2,
    "num_values": 40,
    "blocks": [
      {
        "id": "block10",
        "instructions": [
          {
            "id": "inst19",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [],
        "successors": [
          "block8"
        ]
      },
      {
        "id": "block8",
        "instructions": [
          {
            "id": "inst18",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block10"
        ],
        "successors": [
          "block9"
        ]
      },
      {
        "id": "block9",
        "instructions": [],
        "predecessors": [
          "block8"
        ],
        "successors": []
      }
    ]
  },
  "model_param_setup": {
    "name": "model_param_setup",
    "num_blocks": 43,
    "num_instructions": 84,
    "num_values": 95,
    "blocks": [
      {
        "id": "block0",
        "instructions": [
          {
            "id": "inst1",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param1"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block2",
              "else_block": "block11"
            }
          }
        ],
        "predecessors": [],
        "successors": [
          "block11",
          "block2"
        ]
      },
      {
        "id": "block2",
        "instructions": [
          {
            "id": "inst2",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param0"
            ],
            "results": [
              "v22"
            ]
          },
          {
            "id": "inst3",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v22"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block7",
              "else_block": "block9"
            }
          }
        ],
        "predecessors": [
          "block0"
        ],
        "successors": [
          "block9",
          "block7"
        ]
      },
      {
        "id": "block7",
        "instructions": [
          {
            "id": "inst4",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param0",
              "inf"
            ],
            "results": [
              "v23"
            ]
          },
          {
            "id": "inst5",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block2"
        ],
        "successors": [
          "block9"
        ]
      },
      {
        "id": "block9",
        "instructions": [
          {
            "id": "inst7",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block2: false",
              "block7: v23"
            ],
            "results": [
              "v24"
            ]
          },
          {
            "id": "inst8",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v24"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block4",
              "else_block": "block10"
            }
          }
        ],
        "predecessors": [
          "block2",
          "block7"
        ],
        "successors": [
          "block10",
          "block4"
        ]
      },
      {
        "id": "block10",
        "instructions": [
          {
            "id": "inst9",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst10",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block9"
        ],
        "successors": [
          "block4"
        ]
      },
      {
        "id": "block11",
        "instructions": [
          {
            "id": "inst23",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.00001"
            ],
            "results": [
              "v29"
            ]
          },
          {
            "id": "inst24",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block0"
        ],
        "successors": [
          "block4"
        ]
      },
      {
        "id": "block4",
        "instructions": [
          {
            "id": "inst25",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block9: param0",
              "block10: param0",
              "block11: 0.00001"
            ],
            "results": [
              "v21"
            ]
          },
          {
            "id": "inst26",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param3"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block17",
              "else_block": "block26"
            }
          }
        ],
        "predecessors": [
          "block9",
          "block10",
          "block11"
        ],
        "successors": [
          "block26",
          "block17"
        ]
      },
      {
        "id": "block17",
        "instructions": [
          {
            "id": "inst27",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param2"
            ],
            "results": [
              "v33"
            ]
          },
          {
            "id": "inst28",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v33"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block22",
              "else_block": "block24"
            }
          }
        ],
        "predecessors": [
          "block4"
        ],
        "successors": [
          "block24",
          "block22"
        ]
      },
      {
        "id": "block22",
        "instructions": [
          {
            "id": "inst29",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param2",
              "inf"
            ],
            "results": [
              "v34"
            ]
          },
          {
            "id": "inst30",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block17"
        ],
        "successors": [
          "block24"
        ]
      },
      {
        "id": "block24",
        "instructions": [
          {
            "id": "inst32",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block17: false",
              "block22: v34"
            ],
            "results": [
              "v35"
            ]
          },
          {
            "id": "inst33",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v35"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block19",
              "else_block": "block25"
            }
          }
        ],
        "predecessors": [
          "block17",
          "block22"
        ],
        "successors": [
          "block25",
          "block19"
        ]
      },
      {
        "id": "block25",
        "instructions": [
          {
            "id": "inst34",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst35",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block24"
        ],
        "successors": [
          "block19"
        ]
      },
      {
        "id": "block26",
        "instructions": [
          {
            "id": "inst48",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.00001"
            ],
            "results": [
              "v39"
            ]
          },
          {
            "id": "inst49",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block4"
        ],
        "successors": [
          "block19"
        ]
      },
      {
        "id": "block19",
        "instructions": [
          {
            "id": "inst50",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block24: param2",
              "block25: param2",
              "block26: 0.00001"
            ],
            "results": [
              "v32"
            ]
          },
          {
            "id": "inst51",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param5"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block32",
              "else_block": "block41"
            }
          }
        ],
        "predecessors": [
          "block24",
          "block25",
          "block26"
        ],
        "successors": [
          "block41",
          "block32"
        ]
      },
      {
        "id": "block32",
        "instructions": [
          {
            "id": "inst52",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param4"
            ],
            "results": [
              "v43"
            ]
          },
          {
            "id": "inst53",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v43"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block37",
              "else_block": "block39"
            }
          }
        ],
        "predecessors": [
          "block19"
        ],
        "successors": [
          "block39",
          "block37"
        ]
      },
      {
        "id": "block37",
        "instructions": [
          {
            "id": "inst54",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param4",
              "inf"
            ],
            "results": [
              "v44"
            ]
          },
          {
            "id": "inst55",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block32"
        ],
        "successors": [
          "block39"
        ]
      },
      {
        "id": "block39",
        "instructions": [
          {
            "id": "inst57",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block32: false",
              "block37: v44"
            ],
            "results": [
              "v45"
            ]
          },
          {
            "id": "inst58",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v45"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block34",
              "else_block": "block40"
            }
          }
        ],
        "predecessors": [
          "block32",
          "block37"
        ],
        "successors": [
          "block40",
          "block34"
        ]
      },
      {
        "id": "block40",
        "instructions": [
          {
            "id": "inst59",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst60",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block39"
        ],
        "successors": [
          "block34"
        ]
      },
      {
        "id": "block41",
        "instructions": [
          {
            "id": "inst73",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.5"
            ],
            "results": [
              "v50"
            ]
          },
          {
            "id": "inst74",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block19"
        ],
        "successors": [
          "block34"
        ]
      },
      {
        "id": "block34",
        "instructions": [
          {
            "id": "inst75",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block39: param4",
              "block40: param4",
              "block41: 0.5"
            ],
            "results": [
              "v42"
            ]
          },
          {
            "id": "inst76",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param7"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block47",
              "else_block": "block56"
            }
          }
        ],
        "predecessors": [
          "block39",
          "block40",
          "block41"
        ],
        "successors": [
          "block56",
          "block47"
        ]
      },
      {
        "id": "block47",
        "instructions": [
          {
            "id": "inst77",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param6"
            ],
            "results": [
              "v54"
            ]
          },
          {
            "id": "inst78",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v54"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block52",
              "else_block": "block54"
            }
          }
        ],
        "predecessors": [
          "block34"
        ],
        "successors": [
          "block54",
          "block52"
        ]
      },
      {
        "id": "block52",
        "instructions": [
          {
            "id": "inst79",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param6",
              "inf"
            ],
            "results": [
              "v55"
            ]
          },
          {
            "id": "inst80",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block47"
        ],
        "successors": [
          "block54"
        ]
      },
      {
        "id": "block54",
        "instructions": [
          {
            "id": "inst82",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block47: false",
              "block52: v55"
            ],
            "results": [
              "v56"
            ]
          },
          {
            "id": "inst83",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v56"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block49",
              "else_block": "block55"
            }
          }
        ],
        "predecessors": [
          "block47",
          "block52"
        ],
        "successors": [
          "block55",
          "block49"
        ]
      },
      {
        "id": "block55",
        "instructions": [
          {
            "id": "inst84",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst85",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block54"
        ],
        "successors": [
          "block49"
        ]
      },
      {
        "id": "block56",
        "instructions": [
          {
            "id": "inst98",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.7"
            ],
            "results": [
              "v61"
            ]
          },
          {
            "id": "inst99",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block34"
        ],
        "successors": [
          "block49"
        ]
      },
      {
        "id": "block49",
        "instructions": [
          {
            "id": "inst100",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block54: param6",
              "block55: param6",
              "block56: 0.7"
            ],
            "results": [
              "v53"
            ]
          },
          {
            "id": "inst101",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param9"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block62",
              "else_block": "block71"
            }
          }
        ],
        "predecessors": [
          "block54",
          "block55",
          "block56"
        ],
        "successors": [
          "block71",
          "block62"
        ]
      },
      {
        "id": "block62",
        "instructions": [
          {
            "id": "inst102",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0.2",
              "param8"
            ],
            "results": [
              "v66"
            ]
          },
          {
            "id": "inst103",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v66"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block67",
              "else_block": "block69"
            }
          }
        ],
        "predecessors": [
          "block49"
        ],
        "successors": [
          "block69",
          "block67"
        ]
      },
      {
        "id": "block67",
        "instructions": [
          {
            "id": "inst104",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param8",
              "inf"
            ],
            "results": [
              "v67"
            ]
          },
          {
            "id": "inst105",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block62"
        ],
        "successors": [
          "block69"
        ]
      },
      {
        "id": "block69",
        "instructions": [
          {
            "id": "inst107",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block62: false",
              "block67: v67"
            ],
            "results": [
              "v68"
            ]
          },
          {
            "id": "inst108",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v68"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block64",
              "else_block": "block70"
            }
          }
        ],
        "predecessors": [
          "block62",
          "block67"
        ],
        "successors": [
          "block70",
          "block64"
        ]
      },
      {
        "id": "block70",
        "instructions": [
          {
            "id": "inst109",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst110",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block69"
        ],
        "successors": [
          "block64"
        ]
      },
      {
        "id": "block71",
        "instructions": [
          {
            "id": "inst123",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.5"
            ],
            "results": [
              "v72"
            ]
          },
          {
            "id": "inst124",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block49"
        ],
        "successors": [
          "block64"
        ]
      },
      {
        "id": "block64",
        "instructions": [
          {
            "id": "inst125",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block69: param8",
              "block70: param8",
              "block71: 0.5"
            ],
            "results": [
              "v64"
            ]
          },
          {
            "id": "inst126",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param11"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block77",
              "else_block": "block86"
            }
          }
        ],
        "predecessors": [
          "block69",
          "block70",
          "block71"
        ],
        "successors": [
          "block86",
          "block77"
        ]
      },
      {
        "id": "block77",
        "instructions": [
          {
            "id": "inst127",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param10"
            ],
            "results": [
              "v76"
            ]
          },
          {
            "id": "inst128",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v76"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block82",
              "else_block": "block84"
            }
          }
        ],
        "predecessors": [
          "block64"
        ],
        "successors": [
          "block84",
          "block82"
        ]
      },
      {
        "id": "block82",
        "instructions": [
          {
            "id": "inst129",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param10",
              "inf"
            ],
            "results": [
              "v77"
            ]
          },
          {
            "id": "inst130",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block77"
        ],
        "successors": [
          "block84"
        ]
      },
      {
        "id": "block84",
        "instructions": [
          {
            "id": "inst132",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block77: false",
              "block82: v77"
            ],
            "results": [
              "v78"
            ]
          },
          {
            "id": "inst133",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v78"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block79",
              "else_block": "block85"
            }
          }
        ],
        "predecessors": [
          "block77",
          "block82"
        ],
        "successors": [
          "block85",
          "block79"
        ]
      },
      {
        "id": "block85",
        "instructions": [
          {
            "id": "inst134",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst135",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block84"
        ],
        "successors": [
          "block79"
        ]
      },
      {
        "id": "block86",
        "instructions": [
          {
            "id": "inst148",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.00002"
            ],
            "results": [
              "v83"
            ]
          },
          {
            "id": "inst149",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block64"
        ],
        "successors": [
          "block79"
        ]
      },
      {
        "id": "block79",
        "instructions": [
          {
            "id": "inst150",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block84: param10",
              "block85: param10",
              "block86: 0.00002"
            ],
            "results": [
              "v75"
            ]
          },
          {
            "id": "inst151",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "param13"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block92",
              "else_block": "block101"
            }
          }
        ],
        "predecessors": [
          "block84",
          "block85",
          "block86"
        ],
        "successors": [
          "block101",
          "block92"
        ]
      },
      {
        "id": "block92",
        "instructions": [
          {
            "id": "inst152",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "0",
              "param12"
            ],
            "results": [
              "v87"
            ]
          },
          {
            "id": "inst153",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v87"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block97",
              "else_block": "block99"
            }
          }
        ],
        "predecessors": [
          "block79"
        ],
        "successors": [
          "block99",
          "block97"
        ]
      },
      {
        "id": "block97",
        "instructions": [
          {
            "id": "inst154",
            "opcode": "fle",
            "opcode_category": "comparison",
            "arguments": [
              "param12",
              "inf"
            ],
            "results": [
              "v88"
            ]
          },
          {
            "id": "inst155",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block92"
        ],
        "successors": [
          "block99"
        ]
      },
      {
        "id": "block99",
        "instructions": [
          {
            "id": "inst157",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block92: false",
              "block97: v88"
            ],
            "results": [
              "v89"
            ]
          },
          {
            "id": "inst158",
            "opcode": "br",
            "opcode_category": "control_flow",
            "arguments": [
              "v89"
            ],
            "results": [],
            "branch_targets": {
              "then_block": "block94",
              "else_block": "block100"
            }
          }
        ],
        "predecessors": [
          "block92",
          "block97"
        ],
        "successors": [
          "block100",
          "block94"
        ]
      },
      {
        "id": "block100",
        "instructions": [
          {
            "id": "inst159",
            "opcode": "call",
            "opcode_category": "call",
            "arguments": [],
            "results": []
          },
          {
            "id": "inst160",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block99"
        ],
        "successors": [
          "block94"
        ]
      },
      {
        "id": "block101",
        "instructions": [
          {
            "id": "inst173",
            "opcode": "optbarrier",
            "opcode_category": "other",
            "arguments": [
              "0.05"
            ],
            "results": [
              "v94"
            ]
          },
          {
            "id": "inst174",
            "opcode": "jmp",
            "opcode_category": "control_flow",
            "arguments": [],
            "results": []
          }
        ],
        "predecessors": [
          "block79"
        ],
        "successors": [
          "block94"
        ]
      },
      {
        "id": "block94",
        "instructions": [
          {
            "id": "inst175",
            "opcode": "phi",
            "opcode_category": "phi",
            "arguments": [
              "block99: param12",
              "block100: param12",
              "block101: 0.05"
            ],
            "results": [
              "v86"
            ]
          }
        ],
        "predecessors": [
          "block99",
          "block100",
          "block101"
        ],
        "successors": []
      }
    ]
  },
  "dae_system": {
    "num_unknowns": 4,
    "num_resistive": 8,
    "num_reactive": 0,
    "unknowns": [
      {
        "index": 0,
        "kind": "kirchoff_law",
        "name": "d"
      },
      {
        "index": 1,
        "kind": "kirchoff_law",
        "name": "g"
      },
      {
        "index": 2,
        "kind": "kirchoff_law",
        "name": "s"
      },
      {
        "index": 3,
        "kind": "kirchoff_law",
        "name": "b"
      }
    ],
    "jacobian_entries": 8,
    "jacobian": [
      {
        "row": 0,
        "col": 0,
        "row_name": "d",
        "col_name": "d",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 0,
        "col": 1,
        "row_name": "d",
        "col_name": "g",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 0,
        "col": 2,
        "row_name": "d",
        "col_name": "s",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 0,
        "col": 3,
        "row_name": "d",
        "col_name": "b",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 2,
        "col": 0,
        "row_name": "s",
        "col_name": "d",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 2,
        "col": 1,
        "row_name": "s",
        "col_name": "g",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 2,
        "col": 2,
        "row_name": "s",
        "col_name": "s",
        "has_resist": true,
        "has_react": false
      },
      {
        "row": 2,
        "col": 3,
        "row_name": "s",
        "col_name": "b",
        "has_resist": true,
        "has_react": false
      }
    ],
    "noise_sources": [],
    "topology": {
      "nodes": [
        {
          "id": 0,
          "name": "d",
          "kind": "kirchoff_law"
        },
        {
          "id": 1,
          "name": "g",
          "kind": "kirchoff_law"
        },
        {
          "id": 2,
          "name": "s",
          "kind": "kirchoff_law"
        },
        {
          "id": 3,
          "name": "b",
          "kind": "kirchoff_law"
        }
      ],
      "edges": [
        {
          "from": 1,
          "to": 0,
          "edge_type": "jacobian_resist"
        },
        {
          "from": 2,
          "to": 0,
          "edge_type": "jacobian_resist"
        },
        {
          "from": 3,
          "to": 0,
          "edge_type": "jacobian_resist"
        },
        {
          "from": 0,
          "to": 2,
          "edge_type": "jacobian_resist"
        },
        {
          "from": 1,
          "to": 2,
          "edge_type": "jacobian_resist"
        },
        {
          "from": 3,
          "to": 2,
          "edge_type": "jacobian_resist"
        }
      ]
    }
  },
  "parameters": [
    {
      "kind": "voltage",
      "name": "V(g, b)",
      "value": "v16"
    },
    {
      "kind": "hidden_state",
      "name": "VG",
      "value": "v17"
    },
    {
      "kind": "voltage",
      "name": "V(s, b)",
      "value": "v18"
    },
    {
      "kind": "hidden_state",
      "name": "VS",
      "value": "v19"
    },
    {
      "kind": "voltage",
      "name": "V(d, b)",
      "value": "v20"
    },
    {
      "kind": "hidden_state",
      "name": "VD",
      "value": "v21"
    },
    {
      "kind": "param",
      "name": "VTO",
      "value": "v22"
    },
    {
      "kind": "param",
      "name": "PHI",
      "value": "v24"
    },
    {
      "kind": "param",
      "name": "GAMMA",
      "value": "v26"
    },
    {
      "kind": "hidden_state",
      "name": "VGprime",
      "value": "v30"
    },
    {
      "kind": "hidden_state",
      "name": "VP",
      "value": "v48"
    },
    {
      "kind": "sim_state",
      "name": "$temperature",
      "value": "v58"
    },
    {
      "kind": "hidden_state",
      "name": "n",
      "value": "v73"
    },
    {
      "kind": "param",
      "name": "KP",
      "value": "v80"
    },
    {
      "kind": "param",
      "name": "W",
      "value": "v81"
    },
    {
      "kind": "param",
      "name": "L",
      "value": "v82"
    },
    {
      "kind": "param",
      "name": "THETA",
      "value": "v85"
    },
    {
      "kind": "hidden_state",
      "name": "beta",
      "value": "v92"
    },
    {
      "kind": "hidden_state",
      "name": "x",
      "value": "v102"
    },
    {
      "kind": "hidden_state",
      "name": "iff",
      "value": "v112"
    },
    {
      "kind": "hidden_state",
      "name": "ir",
      "value": "v131"
    },
    {
      "kind": "hidden_state",
      "name": "Ispec",
      "value": "v140"
    },
    {
      "kind": "hidden_state",
      "name": "Id",
      "value": "v143"
    },
    {
      "kind": "unnamed_current",
      "name": "I(d, s)",
      "value": "v144"
    },
    {
      "kind": "param_sys_fun",
      "name": "$mfactor",
      "value": "v155"
    }
  ],
  "outputs": [
    {
      "kind": "IsVoltageSrc(Unnamed { hi: node0, lo: Some(node2) })",
      "value": "v1"
    },
    {
      "kind": "Contribute { dst: Unnamed { hi: node0, lo: Some(node2) }, reactive: false, voltage_src: true }",
      "value": "v3"
    },
    {
      "kind": "Contribute { dst: Unnamed { hi: node0, lo: Some(node2) }, reactive: false, voltage_src: false }",
      "value": "v151"
    }
  ]
};
        window.TEXT_SUMMARY = "Module: ekv\n========================================\n\nPorts:\n  - d\n  - g\n  - s\n  - b\n\nInternal Nodes:\n\nDAE System:\n  Unknowns: 4\n  Resistive equations: 8\n  Reactive equations: 0\n  Jacobian entries: 8\n  Noise sources: 0\n\n  Unknown variables:\n    - KirchoffLaw(d)\n    - KirchoffLaw(g)\n    - KirchoffLaw(s)\n    - KirchoffLaw(b)\n\nFunctions:\n  eval: 9 blocks, 274 values\n  init: 11 blocks, 40 values\n  model_param_setup: 107 blocks, 95 values\n\nParameters (HirInterner):\n  V(g, b) -> v16\n  hidden_state(VG) -> v17\n  V(s, b) -> v18\n  hidden_state(VS) -> v19\n  V(d, b) -> v20\n  hidden_state(VD) -> v21\n  param(VTO) -> v22\n  param(PHI) -> v24\n  param(GAMMA) -> v26\n  hidden_state(VGprime) -> v30\n  hidden_state(VP) -> v48\n  $temperature -> v58\n  hidden_state(n) -> v73\n  param(KP) -> v80\n  param(W) -> v81\n  param(L) -> v82\n  param(THETA) -> v85\n  hidden_state(beta) -> v92\n  hidden_state(x) -> v102\n  hidden_state(iff) -> v112\n  hidden_state(ir) -> v131\n  hidden_state(Ispec) -> v140\n  hidden_state(Id) -> v143\n  I(d, s) -> v144\n  $mfactor -> v155\n\nOutputs:\n  IsVoltageSrc(Unnamed { hi: node0, lo: Some(node2) }) -> v1\n  Contribute { dst: Unnamed { hi: node0, lo: Some(node2) }, reactive: false, voltage_src: true } -> v3\n  Contribute { dst: Unnamed { hi: node0, lo: Some(node2) }, reactive: false, voltage_src: false } -> v151\n\nCallbacks: 0\n\nImplicit Equations: 0\n";
    </script>
    <script>

// Global state
let moduleData = null;
let currentFunction = 'eval';
let currentView = 'code';
let graphRenderer = null;
let zoomBehavior = null;
let currentTransform = null;

// Initialize the visualization
function init(data) {
    moduleData = data;
    renderSidebar();
    renderTabs();
    selectFunction('eval');
}

function renderSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.innerHTML = `
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h3>Module Info</h3>
                <span class="toggle"></span>
            </div>
            <div class="section-content">
                <div class="tree-item">
                    <span class="icon"></span>
                    <span>${moduleData.module_name}</span>
                </div>
                ${moduleData.ports.map(p => `
                    <div class="tree-item">
                        <span class="icon"></span>
                        <span>${p}</span>
                    </div>
                `).join('')}
            </div>
        </div>
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h3>DAE System</h3>
                <span class="toggle"></span>
            </div>
            <div class="section-content">
                <div class="tree-item">
                    <span class="icon"></span>
                    <span>Unknowns: ${moduleData.dae_system.num_unknowns}</span>
                </div>
                <div class="tree-item">
                    <span class="icon"></span>
                    <span>Resistive: ${moduleData.dae_system.num_resistive}</span>
                </div>
                <div class="tree-item">
                    <span class="icon"></span>
                    <span>Reactive: ${moduleData.dae_system.num_reactive}</span>
                </div>
                <div class="tree-item">
                    <span class="icon"></span>
                    <span>Jacobian: ${moduleData.dae_system.jacobian_entries}</span>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h3>Parameters</h3>
                <span class="toggle"></span>
            </div>
            <div class="section-content">
                ${moduleData.parameters.slice(0, 20).map(p => `
                    <div class="tree-item">
                        <span class="icon"></span>
                        <span title="${p.kind}">${p.name}</span>
                    </div>
                `).join('')}
                ${moduleData.parameters.length > 20 ? `
                    <div class="tree-item">
                        <span class="icon">...</span>
                        <span>+${moduleData.parameters.length - 20} more</span>
                    </div>
                ` : ''}
            </div>
        </div>
    `;
}

function renderTabs() {
    const tabs = document.getElementById('tabs');
    const functions = ['eval', 'init', 'model_param_setup'];
    tabs.innerHTML = functions.map(f => {
        const funcData = moduleData[f];
        if (!funcData) return '';
        return `<button class="tab ${f === currentFunction ? 'active' : ''}"
                        onclick="selectFunction('${f}')">${f}</button>`;
    }).join('');
}

function selectFunction(name) {
    currentFunction = name;
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`.tab[onclick="selectFunction('${name}')"]`)?.classList.add('active');
    renderFunctionView();
}

function renderFunctionView() {
    const func = moduleData[currentFunction];
    if (!func) {
        document.getElementById('panel').innerHTML = '<p>Function not available</p>';
        return;
    }

    const panel = document.getElementById('panel');
    panel.innerHTML = `
        <div class="view-tabs">
            <button class="view-tab ${currentView === 'code' ? 'active' : ''}"
                    onclick="switchView('code')">Code</button>
            <button class="view-tab ${currentView === 'topology' ? 'active' : ''}"
                    onclick="switchView('topology')">Topology</button>
            <button class="view-tab ${currentView === 'jacobian' ? 'active' : ''}"
                    onclick="switchView('jacobian')">Jacobian</button>
            <button class="view-tab ${currentView === 'summary' ? 'active' : ''}"
                    onclick="switchView('summary')">Summary</button>
        </div>
        <div id="code-view" style="display: ${currentView === 'code' ? 'block' : 'none'}; height: calc(100% - 40px); overflow: auto;">
            <div class="stats">
                <div class="stat">
                    <div class="stat-value">${func.num_blocks}</div>
                    <div class="stat-label">Blocks</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${func.num_instructions}</div>
                    <div class="stat-label">Instructions</div>
                </div>
                <div class="stat">
                    <div class="stat-value">${func.num_values}</div>
                    <div class="stat-label">Values</div>
                </div>
            </div>
            <div id="blocks-container">
                ${func.blocks.map(block => renderBlock(block)).join('')}
            </div>
        </div>
        <div id="topology-view" class="graph-container" style="display: ${currentView === 'topology' ? 'block' : 'none'}; height: calc(100% - 40px);">
            <div class="graph-controls">
                <button class="graph-btn" onclick="zoomInTopology()">+</button>
                <button class="graph-btn" onclick="zoomOutTopology()">-</button>
                <button class="graph-btn" onclick="resetZoomTopology()">Reset</button>
                <button class="graph-btn" onclick="fitTopologyGraph()">Fit</button>
            </div>
            <div style="position: absolute; top: 10px; left: 16px; max-width: 400px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; padding: 8px 12px; font-size: 11px; z-index: 100;">
                <strong style="color: var(--accent);">Jacobian Dependency Graph</strong><br>
                <span style="color: var(--text-muted);">
                    Nodes are unknowns (voltages/currents). Arrows show Jacobian dependencies:
                    AB means equation for B depends on variable A (f<sub>B</sub>/x<sub>A</sub>  0).
                    Colors: <span style="color: #4caf50;"></span> resistive,
                    <span style="color: #2196f3;"></span> reactive,
                    <span style="color: #ff9800;"></span> both.
                </span>
            </div>
            <div id="topology-graph"></div>
            <div id="topology-tooltip" class="graph-tooltip" style="display: none;"></div>
        </div>
        <div id="jacobian-view" style="display: ${currentView === 'jacobian' ? 'block' : 'none'}; height: calc(100% - 40px); overflow: auto; padding: 16px;">
            <div id="jacobian-container"></div>
        </div>
        <div id="summary-view" style="display: ${currentView === 'summary' ? 'block' : 'none'}; height: calc(100% - 40px); overflow: auto; padding: 16px;">
            <pre>${window.TEXT_SUMMARY || 'Summary not available'}</pre>
        </div>
    `;

    if (currentView === 'topology') {
        setTimeout(() => renderTopologyGraph(), 50);
    } else if (currentView === 'jacobian') {
        setTimeout(() => renderJacobianMatrix(), 50);
    }
}

function switchView(view) {
    currentView = view;
    renderFunctionView();
}

function renderBlock(block) {
    return `
        <div class="block" id="${block.id}">
            <div class="block-header" onclick="toggleBlock('${block.id}')">
                <span class="block-name">${block.id}</span>
                <span class="block-meta">
                    ${block.instructions.length} insts |
                    pred: ${block.predecessors.join(', ') || 'none'} |
                    succ: ${block.successors.join(', ') || 'none'}
                </span>
            </div>
            <div class="block-content" id="${block.id}-content">
                ${block.instructions.map(inst => renderInstruction(inst)).join('')}
            </div>
        </div>
    `;
}

function renderInstruction(inst) {
    const categoryClass = inst.opcode_category || '';
    const result = inst.results.length > 0 ? inst.results.join(', ') + ' =' : '';
    const args = inst.arguments.join(', ');

    return `
        <div class="instruction" data-inst="${inst.id}">
            <span class="inst-result">${result}</span>
            <span class="inst-opcode ${categoryClass}">${inst.opcode}</span>
            <span class="inst-args">${args}</span>
        </div>
    `;
}

function toggleSection(header) {
    const content = header.nextElementSibling;
    const toggle = header.querySelector('.toggle');
    content.classList.toggle('collapsed');
    toggle.textContent = content.classList.contains('collapsed') ? '' : '';
}

function toggleBlock(blockId) {
    const content = document.getElementById(`${blockId}-content`);
    content.style.display = content.style.display === 'none' ? 'block' : 'none';
}

// Search functionality
function setupSearch() {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            filterInstructions(query);
        });
    }
}

function filterInstructions(query) {
    if (!query) {
        document.querySelectorAll('.instruction').forEach(el => el.style.display = 'flex');
        document.querySelectorAll('.block').forEach(el => el.style.display = 'block');
        return;
    }

    document.querySelectorAll('.block').forEach(block => {
        let hasMatch = false;
        block.querySelectorAll('.instruction').forEach(inst => {
            const text = inst.textContent.toLowerCase();
            if (text.includes(query)) {
                inst.style.display = 'flex';
                hasMatch = true;
            } else {
                inst.style.display = 'none';
            }
        });
        block.style.display = hasMatch ? 'block' : 'none';
    });
}

// ==================== TOPOLOGY GRAPH ====================
let topologyZoom = null;

function renderTopologyGraph() {
    const dae = moduleData.dae_system;
    if (!dae || !dae.topology) return;

    const container = document.getElementById('topology-graph');
    if (!container) return;

    const width = container.clientWidth || 800;
    const height = container.clientHeight || 600;

    container.innerHTML = '';

    const svg = d3.select(container)
        .append('svg')
        .attr('width', width)
        .attr('height', height);

    svg.append('defs').append('marker')
        .attr('id', 'topology-arrow')
        .attr('viewBox', '0 -5 10 10')
        .attr('refX', 8)
        .attr('refY', 0)
        .attr('markerWidth', 6)
        .attr('markerHeight', 6)
        .attr('orient', 'auto')
        .append('path')
        .attr('d', 'M0,-5L10,0L0,5')
        .attr('fill', '#808080');

    const g = svg.append('g');

    const dagreGraph = new dagre.graphlib.Graph()
        .setGraph({ rankdir: 'TB', nodesep: 60, ranksep: 80, marginx: 40, marginy: 40 })
        .setDefaultEdgeLabel(() => ({}));

    // Add nodes
    dae.topology.nodes.forEach(node => {
        dagreGraph.setNode(node.id.toString(), {
            label: node.name,
            width: 100,
            height: 50,
            nodeType: node.kind
        });
    });

    // Add edges
    dae.topology.edges.forEach(edge => {
        dagreGraph.setEdge(edge.from.toString(), edge.to.toString(), { edgeType: edge.edge_type });
    });

    dagre.layout(dagreGraph);

    // Draw edges
    g.selectAll('.edgePath')
        .data(dagreGraph.edges())
        .enter()
        .append('g')
        .attr('class', d => `edgePath ${dagreGraph.edge(d).edgeType}`)
        .append('path')
        .attr('d', d => {
            const edge = dagreGraph.edge(d);
            let path = `M${edge.points[0].x},${edge.points[0].y}`;
            for (let i = 1; i < edge.points.length; i++) {
                path += `L${edge.points[i].x},${edge.points[i].y}`;
            }
            return path;
        })
        .attr('marker-end', 'url(#topology-arrow)');

    // Draw nodes
    const nodes = g.selectAll('.node')
        .data(dagreGraph.nodes())
        .enter()
        .append('g')
        .attr('class', d => `node ${dagreGraph.node(d).nodeType}`)
        .attr('transform', d => {
            const node = dagreGraph.node(d);
            return `translate(${node.x - node.width/2}, ${node.y - node.height/2})`;
        });

    nodes.append('rect')
        .attr('width', d => dagreGraph.node(d).width)
        .attr('height', d => dagreGraph.node(d).height);

    nodes.append('text')
        .attr('x', d => dagreGraph.node(d).width / 2)
        .attr('y', d => dagreGraph.node(d).height / 2 + 4)
        .attr('text-anchor', 'middle')
        .text(d => {
            const label = dagreGraph.node(d).label;
            return label.length > 12 ? label.substring(0, 10) + '..' : label;
        });

    topologyZoom = d3.zoom()
        .scaleExtent([0.1, 4])
        .on('zoom', (event) => g.attr('transform', event.transform));

    svg.call(topologyZoom);
    fitTopologyGraph();
}

function zoomInTopology() {
    d3.select('#topology-graph svg').transition().duration(300).call(topologyZoom.scaleBy, 1.3);
}
function zoomOutTopology() {
    d3.select('#topology-graph svg').transition().duration(300).call(topologyZoom.scaleBy, 0.7);
}
function resetZoomTopology() {
    d3.select('#topology-graph svg').transition().duration(300).call(topologyZoom.transform, d3.zoomIdentity);
}
function fitTopologyGraph() {
    const svg = d3.select('#topology-graph svg');
    const g = svg.select('g');
    if (!svg.node() || !g.node()) return;
    const bounds = g.node().getBBox();
    const width = svg.node().clientWidth;
    const height = svg.node().clientHeight;
    if (bounds.width === 0) return;
    const scale = Math.min(0.9 * width / bounds.width, 0.9 * height / bounds.height, 1.5);
    const tx = (width - bounds.width * scale) / 2 - bounds.x * scale;
    const ty = (height - bounds.height * scale) / 2 - bounds.y * scale;
    svg.transition().duration(500).call(topologyZoom.transform, d3.zoomIdentity.translate(tx, ty).scale(scale));
}

// ==================== JACOBIAN MATRIX ====================
function renderJacobianMatrix() {
    const dae = moduleData.dae_system;
    if (!dae) return;

    const container = document.getElementById('jacobian-container');
    if (!container) return;

    const n = dae.num_unknowns;
    const jacobian = dae.jacobian || [];
    const unknowns = dae.unknowns || [];

    // Build sparse matrix representation
    const matrix = {};
    jacobian.forEach(entry => {
        const key = `${entry.row},${entry.col}`;
        matrix[key] = entry;
    });

    // Count entries
    let resistCount = 0, reactCount = 0, bothCount = 0;
    jacobian.forEach(e => {
        if (e.has_resist && e.has_react) bothCount++;
        else if (e.has_resist) resistCount++;
        else if (e.has_react) reactCount++;
    });

    let html = `
        <div class="jacobian-matrix">
            <div class="jacobian-title">Jacobian Matrix (${n} x ${n})</div>
            <div class="jacobian-stats">
                <span>Total entries: ${jacobian.length}</span>
                <span>Resistive: ${resistCount + bothCount}</span>
                <span>Reactive: ${reactCount + bothCount}</span>
                <span>Sparsity: ${((1 - jacobian.length / (n * n)) * 100).toFixed(1)}%</span>
            </div>
    `;

    if (n <= 30) {
        // Small matrix - show full grid
        html += `<div class="jacobian-grid" style="grid-template-columns: 80px repeat(${n}, 24px);">`;

        // Header row
        html += `<div class="jacobian-header"></div>`;
        for (let j = 0; j < n; j++) {
            const name = unknowns[j]?.name || j.toString();
            html += `<div class="jacobian-header jacobian-col-header" title="${name}">${name}</div>`;
        }

        // Data rows
        for (let i = 0; i < n; i++) {
            const rowName = unknowns[i]?.name || i.toString();
            html += `<div class="jacobian-header jacobian-row-header" title="${rowName}">${rowName}</div>`;

            for (let j = 0; j < n; j++) {
                const entry = matrix[`${i},${j}`];
                let cellClass = 'jacobian-cell empty';
                let title = `(${i}, ${j})`;

                if (entry) {
                    if (entry.has_resist && entry.has_react) {
                        cellClass = 'jacobian-cell both';
                        title = `${entry.row_name} / ${entry.col_name}: resist + react`;
                    } else if (entry.has_resist) {
                        cellClass = 'jacobian-cell resist';
                        title = `${entry.row_name} / ${entry.col_name}: resist`;
                    } else if (entry.has_react) {
                        cellClass = 'jacobian-cell react';
                        title = `${entry.row_name} / ${entry.col_name}: react`;
                    }
                }
                if (i === j) cellClass += ' diagonal';

                html += `<div class="${cellClass}" title="${title}"></div>`;
            }
        }
        html += '</div>';
    } else {
        // Large matrix - show summary
        html += `<p style="color: var(--text-muted);">Matrix too large for grid view (${n}x${n}). Showing entry list:</p>`;
        html += `<div style="max-height: 400px; overflow-y: auto;">`;
        jacobian.slice(0, 100).forEach(e => {
            const type = e.has_resist && e.has_react ? 'both' :
                         e.has_resist ? 'resist' : 'react';
            html += `<div style="padding: 4px; border-bottom: 1px solid var(--border);">
                <span style="color: var(--accent);">[${e.row}, ${e.col}]</span>
                ${e.row_name} / ${e.col_name}:
                <span style="color: ${type === 'resist' ? '#4caf50' : type === 'react' ? '#2196f3' : '#ff9800'};">${type}</span>
            </div>`;
        });
        if (jacobian.length > 100) {
            html += `<div style="padding: 8px; color: var(--text-muted);">... and ${jacobian.length - 100} more entries</div>`;
        }
        html += '</div>';
    }

    html += `
        <div class="jacobian-legend">
            <div class="jacobian-legend-item">
                <div class="jacobian-legend-color" style="background: #2d5a3d;"></div>
                <span>Resistive (I)</span>
            </div>
            <div class="jacobian-legend-item">
                <div class="jacobian-legend-color" style="background: #2d3d5a;"></div>
                <span>Reactive (Q)</span>
            </div>
            <div class="jacobian-legend-item">
                <div class="jacobian-legend-color" style="background: #5a4d2d;"></div>
                <span>Both</span>
            </div>
        </div>
    </div>`;

    container.innerHTML = html;
}

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    if (window.MODULE_DATA) {
        init(window.MODULE_DATA);
        setupSearch();
    }
});

    </script>
</body>
</html>